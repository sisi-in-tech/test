What is the total weekly amount earned by all employees in January of each year, 
 for which there is data?  Group this amount by super-sector code.  Exclude "seasonal" 
  data.  Please sort this by total weekly amount earned in descending order.
SELECT * FROM [dbo].[DIM_CE_EMPLOYMENT_METRIC]
SELECT * FROM [dbo].[FACT_CE_ALL_SERIES]

因为根据问题写完后出现了education一栏有重复，所以一种添加GROUP BUY DIM_TIME_ID
方法2 按照education下面的分类，进行order by ， 不进行SUM 

ALTER PROCEDURE P_RPT_TOTAL_WEEKLY_AMT 
AS 
BEGIN 
SELECT 
 YYYYMM = F1.DIM_TIME_ID,
 SUPERSECTOR_NAME = S.SUPERSECTOR_NAME,
 INDUSTRY_NAME = I.INDUSTRY_NAME,
 TOTAL_WEEKLY_AMT= F1.VALUE * F2.VALUE * F3.VALUE--SUM(F1.VALUE * F2.VALUE * F3.VALUE)
--SELECT *
FROM FACT_CE_ALL_SERIES F1 INNER JOIN
     FACT_CE_ALL_SERIES F2
	   ON F1.DIM_CE_SUPERSECTOR_CODE = F2.DIM_CE_SUPERSECTOR_CODE AND
	      F1.DIM_CE_INDUSTRY_CODE = F2.DIM_CE_INDUSTRY_CODE AND
		  F1.DIM_TIME_ID = F2.DIM_TIME_ID AND 
		  F1.YN_SEASONAL = F2.YN_SEASONAL AND
		  F1.DIM_CE_EMPLOYMENT_METRIC_CODE = '01' AND
		  F2.DIM_CE_EMPLOYMENT_METRIC_CODE = '02' INNER JOIN
	 FACT_CE_ALL_SERIES F3
	   ON F1.DIM_CE_SUPERSECTOR_CODE = F3.DIM_CE_SUPERSECTOR_CODE AND
	      F1.DIM_CE_INDUSTRY_CODE = F3.DIM_CE_INDUSTRY_CODE AND
		  F1.DIM_TIME_ID = F3.DIM_TIME_ID AND 
		  F1.YN_SEASONAL = F3.YN_SEASONAL AND
		  F1.DIM_CE_EMPLOYMENT_METRIC_CODE = '01' AND
		  F3.DIM_CE_EMPLOYMENT_METRIC_CODE = '03' INNER JOIN
	 DIM_CE_SUPERSECTOR S
	   ON S.DIM_CE_SUPERSECTOR_CODE = F1.DIM_CE_SUPERSECTOR_CODE INNER JOIN
	 DIM_CE_INDUSTRY I
	   ON I.DIM_CE_INDUSTRY_CODE = F1.DIM_CE_INDUSTRY_CODE
WHERE --S.SUPERSECTOR_NAME = 'Education and health services' AND
      --F1.DIM_TIME_ID = 202001 AND

      F1.DIM_CE_EMPLOYMENT_METRIC_CODE = '01' AND 
      F2.DIM_CE_EMPLOYMENT_METRIC_CODE = '02' AND
	  F3.DIM_CE_EMPLOYMENT_METRIC_CODE = '03' AND
      F1.YN_SEASONAL = 'N' AND
	  F2.YN_SEASONAL = 'N' AND
	  F3.YN_SEASONAL = 'N' AND
	  F1.MTH_PERIOD = 'M01' AND
	  F2.MTH_PERIOD = 'M01' AND 
	  F3.MTH_PERIOD = 'M01'
--GROUP BY F1.DIM_TIME_ID, S.SUPERSECTOR_NAME
ORDER BY F1.DIM_TIME_ID DESC, F1.VALUE * F2.VALUE * F3.VALUE DESC 
-- SUM(F1.VALUE * F2.VALUE * F3.VALUE) DESC

END