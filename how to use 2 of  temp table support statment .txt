HOW TO USE TWO # TEMP TABLE WRITE QUERY ?
* 临时表格#表格名称 中间不可以有任何空格

/***
FOOD_GAS_OR_HOUSEHOLD_FUEL
ITEM_NAME
DIM_TIME_ID
PRICE_IN_USD_FOR_LOS_ANGELES
PRICE_IN_USD_FOR_PACIFIC_REGION
***/

ALTER  PROCEDURE [dbo].[P_LOAD_PACIFIC_LA_PRICE_INF] 
AS 
BEGIN 

SELECT G.GEOGRAPHIC_AREA_NAME , 
       I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, 
	   F.DIM_TIME_ID,
	   F.PRICE_IN_USD,F.DIM_GEOGRAPHIC_AREA_CODE,
	   S.DIM_SERIES_CODE,S.BEGIN_YEAR,S.END_YEAR
--SELECT COUNT(1) 
INTO #T_LA     
FROM FACT_PRICE F INNER JOIN
     DIM_GEOGRAPHIC_AREA G 
         ON G.DIM_GEOGRAPHIC_AREA_CODE=F.DIM_GEOGRAPHIC_AREA_CODE INNER JOIN 
	 DIM_ITEM I 
	     ON F.DIM_ITEM_CODE=I.DIM_ITEM_CODE INNER JOIN  
     DIM_SERIES S 
		  ON S.DIM_GEOGRAPHIC_AREA_CODE=G.DIM_GEOGRAPHIC_AREA_CODE AND
			 S.DIM_ITEM_CODE = I.DIM_ITEM_CODE
WHERE  F.DIM_GEOGRAPHIC_AREA_CODE = 'A421'
ORDER BY I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, F.DIM_TIME_ID, 
 G.GEOGRAPHIC_AREA_NAME

SELECT G.GEOGRAPHIC_AREA_NAME , 
       I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, 
	   F.DIM_TIME_ID,
	   F.PRICE_IN_USD,F.DIM_GEOGRAPHIC_AREA_CODE,
	   S.DIM_SERIES_CODE,S.BEGIN_YEAR,S.END_YEAR
--SELECT COUNT(1) 
INTO #T_PAC
FROM FACT_PRICE F INNER JOIN
     DIM_GEOGRAPHIC_AREA G 
         ON G.DIM_GEOGRAPHIC_AREA_CODE=F.DIM_GEOGRAPHIC_AREA_CODE INNER JOIN 
	 DIM_ITEM I 
	     ON F.DIM_ITEM_CODE=I.DIM_ITEM_CODE INNER JOIN  
             DIM_SERIES S 
		  ON S.DIM_GEOGRAPHIC_AREA_CODE=G.DIM_GEOGRAPHIC_AREA_CODE AND
			 S.DIM_ITEM_CODE = I.DIM_ITEM_CODE
WHERE F.DIM_GEOGRAPHIC_AREA_CODE ='0000' 

SELECT FOOD_GAS_OR_HOUSEHOLD_FUEL = #T_LA.FOOD_GAS_OR_HOUSEHOLD_FUEL,   ( JOIN 两个临时表格）
	ITEM_NAME = #T_LA.ITEM_NAME,
	DIM_TIME_ID = #T_LA.DIM_TIME_ID,
	PRICE_IN_USD_FOR_LOS_ANGELES = #T_LA.PRICE_IN_USD,
	PRICE_IN_USD_FOR_PACIFIC_REGION = #T_PAC.PRICE_IN_USD
FROM #T_LA INNER JOIN
     #T_PAC
	   ON #T_LA.ITEM_NAME = #T_PAC.ITEM_NAME AND 
	      #T_LA.DIM_TIME_ID = #T_PAC.DIM_TIME_ID
ORDER BY DIM_TIME_ID DESC, FOOD_GAS_OR_HOUSEHOLD_FUEL, ITEM_NAME

END 

/******************************************
自己写的

TRUNCATE TABLE #T	
			  
ALTER PROCEDURE P_LOAD_PACIFIC_LA_AREA_PRICE 
AS 
BEGIN 

SELECT G.GEOGRAPHIC_AREA_NAME , 
       I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, 
	   F.DIM_TIME_ID,
	   PRICE_IN_USD_FOR_LOS_ANGELES = F.PRICE_IN_USD,
	   F.DIM_GEOGRAPHIC_AREA_CODE
INTO #T
FROM FACT_PRICE F INNER JOIN
     DIM_GEOGRAPHIC_AREA G 
         ON G.DIM_GEOGRAPHIC_AREA_CODE=F.DIM_GEOGRAPHIC_AREA_CODE INNER JOIN 
	 DIM_ITEM I 
	     ON F.DIM_ITEM_CODE=I.DIM_ITEM_CODE  
     
WHERE F.DIM_GEOGRAPHIC_AREA_CODE = 'A421' 
ORDER BY I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, F.DIM_TIME_ID, 
 G.GEOGRAPHIC_AREA_NAME

SELECT G.GEOGRAPHIC_AREA_NAME , 
       I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, 
	   F.DIM_TIME_ID,
	   PRICE_IN_USD_FOR_PACIFIC_REGION = F.PRICE_IN_USD,
	   F.DIM_GEOGRAPHIC_AREA_CODE
	  
FROM FACT_PRICE F INNER JOIN
     DIM_GEOGRAPHIC_AREA G 
         ON G.DIM_GEOGRAPHIC_AREA_CODE=F.DIM_GEOGRAPHIC_AREA_CODE INNER JOIN 
	 DIM_ITEM I 
	     ON F.DIM_ITEM_CODE=I.DIM_ITEM_CODE FULL OUTER JOIN 
	 #T 
	     ON #T.ITEM_NAME= I.ITEM_NAME
		 
WHERE F.DIM_GEOGRAPHIC_AREA_CODE = '0490'OR F.DIM_GEOGRAPHIC_AREA_CODE = 'A421' 

ORDER BY I.FOOD_GAS_OR_HOUSEHOLD_FUEL, I.ITEM_NAME, F.DIM_TIME_ID, 
 G.GEOGRAPHIC_AREA_NAME

END 

     